var ams=ams||{};ams.PeriodHandler={_startdate:null,_enddate:null,_previousdate:null,_control:null,_maxdate:null,init:function(map){this._updatePeriodInfo();let options={startDate:this._startdate};this._control||(this._control=L.control.PeriodHandler(options)),this._control.addTo(map),this._control._setDatepicker(options)},remove:function(map){this._control&&(map.removeControl(this._control),this._control=null)},_updatePeriodInfo:function(){this._startdate=new Date(ams.App._dateControl.startdate+"T00:00:00"),this._enddate=new Date(ams.App._dateControl.enddate+"T00:00:00"),this._enddate.setUTCDate(this._enddate.getUTCDate()+1),this._previousdate=new Date(ams.App._dateControl.prevdate+"T00:00:00"),this._previousdate.setUTCDate(this._previousdate.getUTCDate()+1),null===this._maxdate&&(this._maxdate=this._startdate)},changeDate:function(date,datetype){void 0!==date&&ams.App._dateControl.setPeriod(date,ams.App._currentTemporalAggregate,datetype),ams.App._suViewParams.updateDates(ams.App._dateControl),ams.App._priorViewParams.updateDates(ams.App._dateControl),ams.App.hasSpatialUnitLayer()?ams.App._updateSpatialUnitLayer():ams.App.addSpatialUnitLayer(),ams.App._updateReferenceLayer(),this._updatePeriodInfo(),$("#datepicker-start").datepicker().val(this._startdate.toLocaleDateString("pt-BR")),$("#datepicker-end").datepicker().val(this._enddate.toLocaleDateString("pt-BR")),ams.App._dateControl.hasNext(ams.App._dateControl.getNext())?$("#next-period").css("visibility","unset"):$("#next-period").css("visibility","hidden")},setMaxDate:function(maxdate){ams.Utils.assert("string"==typeof maxdate),this._maxdate=ams.Date.fromString(maxdate),$("#datepicker-start").datepicker("option","maxDate",this._maxdate)},previousPeriod:function(){ams.App._dateControl.toPrevious(),this.changeDate()},nextPeriod:function(){ams.App._dateControl.toNext(),this.changeDate()}};